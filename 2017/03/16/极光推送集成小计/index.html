<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>  · codeTalk</title><meta name="description" content=" - zjcai"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/codeTalkCC" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/selfAbout.html" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title"></h1><div class="post-info">2017年3月16日</div><div class="post-content"><h1 id="极光推送集成小计"><a href="#极光推送集成小计" class="headerlink" title="极光推送集成小计"></a>极光推送集成小计</h1><h4 id="资料整理"><a href="#资料整理" class="headerlink" title="资料整理"></a>资料整理</h4><ul>
<li><a href="https://www.jiguang.cn/dev/#/app/list#dev" target="_blank" rel="external">极光推送服务网址</a></li>
<li><a href="http://docs.jiguang.cn/" target="_blank" rel="external">极光推送文档</a></li>
</ul>
<h4 id="步骤小计"><a href="#步骤小计" class="headerlink" title="步骤小计"></a>步骤小计</h4><ol>
<li>注册极光账号</li>
<li>创建应用获取AppKey</li>
<li>上传开发证书和生产证书（<a href="http://www.jianshu.com/p/c60eb29db67e" target="_blank" rel="external">如何得到推送证书?</a>）</li>
<li>代码集成</li>
</ol>
<blockquote>
<p>pod ‘JPush’</p>
</blockquote>
<p>集成接口然后引入头文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;JPush/JPUSHService.h&gt;</span><br></pre></td></tr></table></figure>
<p>填入代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> //极光推送</span><br><span class="line">JPUSHRegisterEntity *entity = [[JPUSHRegisterEntity alloc] init];</span><br><span class="line">entity.types = JPAuthorizationOptionAlert|JPAuthorizationOptionBadge|JPAuthorizationOptionSound;</span><br><span class="line">[JPUSHService registerForRemoteNotificationConfig:entity delegate:self];</span><br><span class="line">    </span><br><span class="line">// Required</span><br><span class="line">// init Push</span><br><span class="line">// notice: 2.1.5版本的SDK新增的注册方法，改成可上报IDFA，如果没有使用IDFA直接传nil</span><br><span class="line">// 如需继续使用pushConfig.plist文件声明appKey等配置内容，请依旧使用[JPUSHService setupWithOption:launchOptions]方式初始化。</span><br><span class="line">NSString *app_key_jpush = @&quot;你自己的值，在应用设置里可以看到&quot;;</span><br><span class="line">[JPUSHService setupWithOption:nil appKey:app_key_jpush channel:@&quot;App Store&quot; apsForProduction:NO];</span><br></pre></td></tr></table></figure>
<p>发送token</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//注册远程通知成功</span><br><span class="line">- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken&#123;</span><br><span class="line">    NSLog(@&quot;接收到deviceToken&quot;);</span><br><span class="line">    /// Required - 注册 DeviceToken</span><br><span class="line">    </span><br><span class="line">    [JPUSHService registerDeviceToken:deviceToken];</span><br><span class="line">    NSLog(@&quot;%@&quot;, deviceToken.description);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//注册远程通知失败</span><br><span class="line">- (void)application:(UIApplication *)application didFailToRegisterForRemoteNotificationsWithError:(NSError *)error&#123;</span><br><span class="line">    //Optional</span><br><span class="line">    NSLog(@&quot;did Fail To Register For Remote Notifications With Error: %@&quot;, error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现代理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">JPUSHRegisterDelegate</span><br><span class="line"></span><br><span class="line">#pragma mark - 极光推送</span><br><span class="line">#pragma mark- JPUSHRegisterDelegate</span><br><span class="line"></span><br><span class="line">// iOS 10 Support</span><br><span class="line">- (void)jpushNotificationCenter:(UNUserNotificationCenter *)center willPresentNotification:(UNNotification *)notification withCompletionHandler:(void (^)(NSInteger))completionHandler &#123;</span><br><span class="line">    // Required</span><br><span class="line">    NSDictionary * userInfo = notification.request.content.userInfo;</span><br><span class="line">    if([notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</span><br><span class="line">        [JPUSHService handleRemoteNotification:userInfo];</span><br><span class="line">    &#125;</span><br><span class="line">    UNNotificationPresentationOptions options = UNNotificationPresentationOptionSound | UNNotificationPresentationOptionAlert;</span><br><span class="line">    completionHandler(options); // 需要执行这个方法，选择是否提醒用户，有Badge、Sound、Alert三种类型可以选择设置</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// iOS 10 Support</span><br><span class="line">- (void)jpushNotificationCenter:(UNUserNotificationCenter *)center didReceiveNotificationResponse:(UNNotificationResponse *)response withCompletionHandler:(void (^)())completionHandler &#123;</span><br><span class="line">    // Required</span><br><span class="line">    NSDictionary * userInfo = response.notification.request.content.userInfo;</span><br><span class="line">    if([response.notification.request.trigger isKindOfClass:[UNPushNotificationTrigger class]]) &#123;</span><br><span class="line">        [JPUSHService handleRemoteNotification:userInfo];</span><br><span class="line">    &#125;</span><br><span class="line">    completionHandler();  // 系统要求执行这个方法</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> jpush设置别名</span><br><span class="line"></span><br><span class="line"> @param userString 别名 - 用户名</span><br><span class="line"> */</span><br><span class="line">- (void)setAliasWithString:(NSString *)userString&#123;</span><br><span class="line">    [JPUSHService setTags:nil alias:userString fetchCompletionHandle:^(int iResCode, NSSet *iTags, NSString *iAlias) &#123;</span><br><span class="line">        NSLog(@&quot;rescode: %d, \ntags: %@, \nalias: %@\n&quot;, iResCode, iTags , iAlias);</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (void)loginSucess&#123;</span><br><span class="line">    [self setAliasWithString:g_user.userString];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个基本的极光推送就差不多弄好了</p>
</div></article></div></section><footer><div class="paginator"><a href="/2016/07/22/网络编程/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2017 <a href="http://yoursite.com">zjcai</a>, unless otherwise noted.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>